<aside class="listing-sidebar" th:fragment="authorInfoSidebar">
    <div class="seller-card hover-animation-card" th:if="${listing.author != null}" style="cursor: pointer;" th:onclick="window.location.href = '/profile/' + [[${listing.author.id}]]">
        <img class="seller-avatar avatar p100-avatar" 
            th:src="@{${listing.author.avatarUrl}}"
            th:onerror="this.src='/images/avatar-placeholder.png'"
            alt="–ê–≤–∞—Ç–∞—Ä –ø—Ä–æ–¥–∞–≤—Ü–∞">
        <div class="seller-info">
            <h4 th:text="${listing.author.name ?: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–≤—Ç–æ—Ä'}">–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤</h4>
            <div class="seller-rating">
                <span th:text="#{listing.rating}">–†–µ–π—Ç–∏–Ω–≥: </span>
                <span th:text="${listing.author.averageRating}">4.5</span> ‚òÖ
            </div>
        </div>
        <div class="seller-actions">
            <div th:if="${isAuthenticated}">
                <!-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–ª–∞–¥–µ–ª–µ—Ü -->
                <div th:unless="${isOwner}">
                    <form action="/secure/messenger/chat" method="get">
                        <input type="hidden" name="sellerId" th:value="${listing.author.id}">
                        <input type="hidden" name="listingId" th:value="${listing.id}">
                        <button type="submit" class="btn btn-primary" th:text="#{listing.write}">–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                    </form>
                    <form th:action="@{/listing/{id}/favorite(id=${listing.id})}" method="post" style="display: inline;">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <button type="submit" class="btn btn-outline-primary"
                                th:text="${isFavorite} ? #{listing.favorite.remove} : #{listing.favorite.add}">
                        </button>
                    </form>
                </div>

                <!-- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ -->
                <a th:href="@{'/secure/listing/edit/' + ${listing.id}}"
                    class="btn btn-primary"
                    th:if="${isOwner}" th:text="#{listing.edit}"></a>
            </div>
            <div th:unless="${isAuthenticated}">
                <a href="/login" class="btn btn-primary" th:text="#{login.to.write}"></a>
            </div>
        </div>
    </div>

    <div class="contact-card" th:if="${listing.author != null}">
        <h3 th:text="#{listing.author.contacts}">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <div class="contact-methods">
            <div class="contact-item" th:if="${listing.author.phoneVisible and listing.author.phone != null}">
                <span class="contact-icon">üì±</span>
                <span th:text="${listing.author.phone}"></span>
            </div>
            <div class="contact-item" th:if="${listing.author.emailVisible and listing.author.email != null}">
                <span class="contact-icon">‚úâÔ∏è</span>
                <span th:text="${listing.author.email}"></span>
            </div>
            <span th:if="${!(listing.author.phoneVisible and listing.author.phone != null) and !(listing.author.emailVisible and listing.author.email != null)}" th:text="#{no.contacts}"></span>
        </div>
    </div>
</aside>

<aside class="resume-sidebar" th:fragment="authorInfoSidebarResume">
    <div class="seller-card hover-animation-card" style="cursor: pointer;" th:onclick="window.location.href = '/profile/' + [[${resume.user.id}]]">
        <img class="seller-avatar avatar p100-avatar"
            th:src="@{${resume.user.avatarUrl}}"
            th:onerror="this.src='/images/avatar-placeholder.png'"
            alt="–ê–≤–∞—Ç–∞—Ä –∫–∞–Ω–¥–∏–¥–∞—Ç–∞">
        <div class="seller-info">
            <h3 th:text="${resume.user.name}">–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤</h3>
            <div class="seller-rating">
                <span class="rating">
                    <th:block th:each="i : ${#numbers.sequence(1,5)}">
                        <i class="fa"
                            th:classappend="${resume.user.averageRating >= i} ? 'fa-star' :
                            (${resume.user.averageRating >= i - 0.5} ? 'fa-star-half-o' : 'fa-star-o')"></i>
                    </th:block>
                </span>
                <span th:text="'(' + ${#numbers.formatDecimal(resume.user.averageRating, 1, 1)} + ')'">(4.5)</span>
            </div>
        </div>
        <div class="seller-actions" th:if="${isAuthenticated}">
            <!-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–ª–∞–¥–µ–ª–µ—Ü -->
            <div th:unless="${isOwner}">
                <form action="/secure/messenger/chat" method="get">
                    <input type="hidden" name="sellerId" th:value="${resume.user.id}">
                    <button type="submit" class="btn btn-primary" th:text="#{listing.write}">–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                </form>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ -->
            <div th:if="${isOwner}">
                <a th:href="@{'/secure/resume'}"
                    class="btn btn-primary"
                    th:text="#{resume.edit}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            </div>
        </div>
        <div th:unless="${isAuthenticated}" class="seller-actions">
            <a href="/login" class="btn btn-primary" th:text="#{login.to.contact}">–í–æ–π—Ç–∏, —á—Ç–æ–±—ã —Å–≤—è–∑–∞—Ç—å—Å—è</a>
        </div>
    </div>

    <div class="contact-card" th:if="${resume.user != null}">
        <h3 th:text="#{listing.author.contacts}">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <div class="contact-methods">
            <div class="contact-item" th:if="${resume.user.phoneVisible and resume.user.phone != null}">
                <span class="contact-icon">üì±</span>
                <span th:text="${resume.user.phone}"></span>
            </div>
            <div class="contact-item" th:if="${resume.user.emailVisible and resume.user.email != null}">
                <span class="contact-icon">‚úâÔ∏è</span>
                <span th:text="${resume.user.email}"></span>
            </div>
            <span th:if="${!(resume.user.phoneVisible and resume.user.phone != null) and !(resume.user.emailVisible and resume.user.email != null)}" th:text="#{no.contacts}"></span>
        </div>
    </div>
</aside>

<aside class="listing-sidebar" th:fragment="profileInfoSidebar">
    <div class="seller-card" th:if="${profileUser != null}">
        <img class="seller-avatar avatar p100-avatar"
            th:src="@{${profileUser.avatarUrl}}"
            th:onerror="this.src='/images/avatar-placeholder.png'"
            alt="–ê–≤–∞—Ç–∞—Ä –ø—Ä–æ–¥–∞–≤—Ü–∞">
        <div class="seller-info">
            <h4 th:text="${profileUser.name ?: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–≤—Ç–æ—Ä'}">–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤</h4>
            <div class="seller-rating">
                <span th:text="#{listing.rating}">–†–µ–π—Ç–∏–Ω–≥: </span>
                <span th:text="${profileUser.averageRating}">4.5</span> ‚òÖ
            </div>
        </div>
        <div class="seller-actions">
            <div th:if="${isAuthenticated}">
                <!-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–ª–∞–¥–µ–ª–µ—Ü -->
                <div th:unless="${isOwner}">
                    <form action="/secure/messenger/chat" method="get">
                        <input type="hidden" name="sellerId" th:value="${profileUser.id}">
                        <button type="submit" class="btn btn-primary" th:text="#{listing.write}">–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                    </form>
                </div>

                <!-- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ -->
                <a th:href="@{'/secure/account/edit/'}"
                    class="btn btn-primary"
                    th:if="${isOwner}" th:text="#{listing.edit}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            </div>
            <div th:unless="${isAuthenticated}">
                <a href="/login" class="btn btn-primary" th:text="#{login.to.write}">–í–æ–π—Ç–∏, —á—Ç–æ–±—ã –Ω–∞–ø–∏—Å–∞—Ç—å</a>
            </div>
        </div>
    </div>

    <div class="contact-card" th:if="${profileUser != null}">
        <h3 th:text="#{listing.author.contacts}">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <div class="contact-methods">
            <div class="contact-item" th:if="${profileUser.phoneVisible and profileUser.phone != null}">
                <span class="contact-icon">üì±</span>
                <span th:text="${profileUser.phone}"></span>
            </div>
            <div class="contact-item" th:if="${profileUser.emailVisible and profileUser.email != null}">
                <span class="contact-icon">‚úâÔ∏è</span>
                <span th:text="${profileUser.email}"></span>
            </div>
            <span th:if="${!(profileUser.phoneVisible and profileUser.phone != null) and !(profileUser.emailVisible and profileUser.email != null)}" th:text="#{no.contacts}"></span>
        </div>
    </div>
    
    <div class="resume-card hover-animation-card" th:if="${resume != null and resume.published}" th:onclick="window.location.href = '/resume/' + [[${resume.id}]]">
        <img th:src="@{${profileUser.avatarUrl}}"
                class="avatar p70-avatar"
                alt="–ê–≤–∞—Ç–∞—Ä"
                th:onerror="this.src='/images/avatar-placeholder.png'">
        <div class="resume-info">
            <h3 th:text="${resume.profession}">–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</h3>
            <div class="resume-meta">
                <span class="resume-education" th:text="#{'education.' + ${resume.education}}">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</span>
            </div>
        </div>
    </div>
</aside>