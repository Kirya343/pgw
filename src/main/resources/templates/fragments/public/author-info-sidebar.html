<aside class="listing-sidebar" th:fragment="authorInfoSidebar">
    <div class="seller-card" th:if="${listing.author != null}">
        <div class="seller-avatar">
            <img th:src="@{${authorAvatarPath}}"
                    th:onerror="this.src='/images/default-avatar.png'"
                    alt="–ê–≤–∞—Ç–∞—Ä –ø—Ä–æ–¥–∞–≤—Ü–∞">
        </div>
        <div class="seller-info">
            <h4 th:text="${listing.author.name ?: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–≤—Ç–æ—Ä'}">–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤</h4>
            <div class="seller-rating">
                <span th:text="#{listing.rating}">–†–µ–π—Ç–∏–Ω–≥: </span>
                <span th:text="${listing.author.averageRating}">4.5</span> ‚òÖ
            </div>
            <!-- <div class="seller-stats">
                <span th:text="${listing.author.completedJobs != null ? listing.author.completedJobs : '0'}">0</span>
            </div> -->
        </div>
        <div class="seller-actions">
            <div th:if="${isAuthenticated}">
                <!-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–ª–∞–¥–µ–ª–µ—Ü -->
                <div th:unless="${isOwner}">
                    <form action="/secure/messenger/chat" method="get">
                        <input type="hidden" name="sellerId" th:value="${listing.author.id}">
                        <input type="hidden" name="listingId" th:value="${listing.id}">
                        <button type="submit" class="btn btn-primary" th:text="#{listing.write}">–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                    </form>
                    <form th:action="@{/listing/{id}/favorite(id=${listing.id})}" method="post" style="display: inline;">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <button type="submit" class="btn btn-outline-primary"
                                th:text="${isFavorite} ? #{listing.favorite.remove} : #{listing.favorite.add}">
                        </button>
                    </form>
                </div>

                <!-- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ -->
                <a th:href="@{'/secure/listing/edit/' + ${listing.id}}"
                    class="btn btn-primary"
                    th:if="${isOwner}" th:text="#{listing.edit}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            </div>
            <div th:unless="${isAuthenticated}">
                <a href="/login" class="btn btn-primary" th:text="#{login.to.write}">–í–æ–π—Ç–∏, —á—Ç–æ–±—ã –Ω–∞–ø–∏—Å–∞—Ç—å</a>
            </div>
        </div>
    </div>

    <div class="contact-card" th:if="${listing.author != null}">
        <h3 th:text="#{listing.author.contacts}">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <div class="contact-methods">
            <div class="contact-item">
                <span class="contact-icon">üì±</span>
                <span th:text="${listing.author.phoneVisible ? (listing.author.phone != null ? listing.author.phone : '–ù–µ —É–∫–∞–∑–∞–Ω') : '–°–∫—Ä—ã—Ç–æ'}">–ù–µ —É–∫–∞–∑–∞–Ω</span>
            </div>
            <div class="contact-item">
                <span class="contact-icon">‚úâÔ∏è</span>
                <span class="contact-value"
                        th:text="${listing.author.emailVisible ? (listing.author.email != null ? listing.author.email : '–ù–µ —É–∫–∞–∑–∞–Ω') : '–°–∫—Ä—ã—Ç–æ'}">–ù–µ —É–∫–∞–∑–∞–Ω</span>
            </div>
        </div>
    </div>

</aside>